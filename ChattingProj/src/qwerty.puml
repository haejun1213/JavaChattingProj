@startuml

start

title 클라이언트 서비스 워크플로우

:클라이언트 연결 수립;
:클라이언트 이름을 입력받음;

while (이름이 고유한가?) is (아니오)
    :중복된 이름을 알려주고 다른 이름을 요청;
endwhile

:클라이언트와 연결 성공;
:서버로부터 채팅 참여 메시지 전송;
:메시지를 수신하는 스레드 시작;

while (클라이언트가 메시지를 보내는 동안) is (예)
    :클라이언트 메시지 수신;

    if (메시지가 닉네임 변경 요청인가?) then (예)
        :닉네임 변경 처리;
    elseif (메시지가 개인 메시지인가?) then (예)
        :개인 메시지 전송 처리;
    elseif (메시지가 이미지 전송인가?) then (예)
        :이미지 파일 수신 및 서버에 저장;
    elseif (메시지가 이미지 요청인가?) then (예)
        :이미지 전송 요청 처리;
    elseif (메시지가 /list 요청인가?) then (예)
        :온라인 클라이언트 목록 전송;
    elseif (메시지가 종료 명령어인가?) then (예)
        :서버에 퇴장 메시지 전송;
        :클라이언트 연결 종료;
        break;
    else
        :일반 메시지 처리 (모든 클라이언트에게 전송);
    endif
endwhile

:소켓 및 스트림 종료;
stop

@enduml
